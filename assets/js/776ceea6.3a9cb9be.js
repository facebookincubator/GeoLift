"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[679],{3905:function(e,t,o){o.d(t,{Zo:function(){return h},kt:function(){return f}});var n=o(7294);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function i(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function r(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?i(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function l(e,t){if(null==e)return{};var o,n,a=function(e,t){if(null==e)return{};var o,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var s=n.createContext({}),u=function(e){var t=n.useContext(s),o=t;return e&&(o="function"==typeof e?e(t):r(r({},t),e)),o},h=function(e){var t=u(e.components);return n.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var o=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,h=l(e,["components","mdxType","originalType","parentName"]),p=u(o),f=a,d=p["".concat(s,".").concat(f)]||p[f]||c[f]||i;return o?n.createElement(d,r(r({ref:t},h),{},{components:o})):n.createElement(d,r({ref:t},h))}));function f(e,t){var o=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=o.length,r=new Array(i);r[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,r[1]=l;for(var u=2;u<i;u++)r[u]=o[u];return n.createElement.apply(null,r)}return n.createElement.apply(null,o)}p.displayName="MDXCreateElement"},5201:function(e,t,o){o.r(t),o.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return u},assets:function(){return h},toc:function(){return c},default:function(){return f}});var n=o(3117),a=o(102),i=(o(7294),o(3905)),r=["components"],l={slug:"inverse-geolift",title:"Inverse GeoLift - inference done cheaper",authors:["nicolas"],tags:["GeoLift","Geo Measurement","Inverse GeoLift"]},s=void 0,u={permalink:"/GeoLift/blog/inverse-geolift",editUrl:"https://github.com/facebookincubator/GeoLift/blog/2022-05-12-InverseGeoLift.md",source:"@site/blog/2022-05-12-InverseGeoLift.md",title:"Inverse GeoLift - inference done cheaper",description:"TL;DR:",date:"2022-05-12T00:00:00.000Z",formattedDate:"May 12, 2022",tags:[{label:"GeoLift",permalink:"/GeoLift/blog/tags/geo-lift"},{label:"Geo Measurement",permalink:"/GeoLift/blog/tags/geo-measurement"},{label:"Inverse GeoLift",permalink:"/GeoLift/blog/tags/inverse-geo-lift"}],readingTime:6.115,truncated:!1,authors:[{name:"Nicolas Cruces",title:"Marketing Science @ Meta | GeoLift Team",url:"https://github.com/NicolasMatrices-v2",imageURL:"https://github.com/NicolasMatrices-v2.png",key:"nicolas"}],nextItem:{title:"Launching GeoLift v2.3 - Streamlined and Improved Power Calculations",permalink:"/GeoLift/blog/geolift-v23"}},h={authorsImageUrls:[void 0]},c=[{value:"TL;DR:",id:"tldr",children:[],level:2},{value:"Introduction and motivation",id:"introduction-and-motivation",children:[],level:2},{value:"A new hope",id:"a-new-hope",children:[],level:2},{value:"Tips for building and analyzing an Inverse GeoLift",id:"tips-for-building-and-analyzing-an-inverse-geolift",children:[{value:"Determine budget for the test.",id:"determine-budget-for-the-test",children:[],level:3},{value:"Keep an eye on the weights for the counterfactual.",id:"keep-an-eye-on-the-weights-for-the-counterfactual",children:[],level:3},{value:"Look for symmetric power curves",id:"look-for-symmetric-power-curves",children:[],level:3},{value:"Calculate the Treatment\u2019s CPIC",id:"calculate-the-treatments-cpic",children:[],level:3}],level:2},{value:"What\u2019s up next?",id:"whats-up-next",children:[],level:2},{value:"Want to try out your first Inverse GeoLift?",id:"want-to-try-out-your-first-inverse-geolift",children:[],level:2}],p={toc:c};function f(e){var t=e.components,o=(0,a.Z)(e,r);return(0,i.kt)("wrapper",(0,n.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"tldr"},"TL;DR:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Inverse GeoLifts help advertisers reduce geo experiment holdout sizes by inverting who sees ads: they show ads to the control group and do not show ads to the treatment group."),(0,i.kt)("li",{parentName:"ul"},"Given that geo-experiments require large control groups, Inverse GeoLifts are a good way of reducing holdout groups and opportunity cost without losing testing accuracy."),(0,i.kt)("li",{parentName:"ul"},"While Standard GeoLifts are great tools to measure a new media activity, ongoing media is best tested with an Inverse GeoLift."),(0,i.kt)("li",{parentName:"ul"},"MMM calibration: Standard GeoLifts are straightforward inputs into MMMs, while Inverse GeoLifts have a larger complexity for this use case.")),(0,i.kt)("h2",{id:"introduction-and-motivation"},"Introduction and motivation"),(0,i.kt)("p",null,"GeoLift is an end-to-end solution that empowers you to determine the real effect of media via geographical experiments."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"It\u2019s causal."),"  GeoLift follows the KPI of a treatment group and compares it to what would have happened to that treatment group, if they had not been treated.  This is what we call a counterfactual.  The latter is built off of control locations that will not be exposed to the treatment effect and paired as close as possible to the treatment group, prior to the test."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"It\u2019s transparent."),"  Being an open source package ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/facebookincubator/GeoLift"},"hosted on Github"),", the code is freely available for everyone to use and inspect."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"It sets you up for success."),"  There are many packages that help you analyze geographical quasi-experiments.  There\u2019s only one that runs power analysis via simulations to help the user define where the treatment should be applied, on top of the standard analysis module."),(0,i.kt)("li",{parentName:"ul"},"It\u2019s based on ",(0,i.kt)("a",{parentName:"li",href:"https://www.tandfonline.com/doi/abs/10.1080/01621459.2021.1929245"},"cutting-edge econometric models"),".")),(0,i.kt)("p",null,"In order to construct a robust counterfactual, GeoLift usually requires more than half the amount of available locations to be part of the control group.  This is because the counterfactual is created as a linear combination of the units in the pool of controls, therefore, richer pools tend to provide more robust counterfactuals.  Standard GeoLifts can be a great setup when you are trying to measure the positive effect that new media has on your business."),(0,i.kt)("p",null,"However, ",(0,i.kt)("strong",{parentName:"p"},"it can be detrimental to run an experiment with a large holdout when you would like to measure ongoing media efforts"),".  This has to do with the opportunity cost of running a test.  When you are holding out media from certain locations, your total KPI will decrease by the effect that media has in those locations, scaled by the size of the holdout."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://github.com/facebookincubator/GeoLift/blob/main/website/static/img/OppCost.png?raw=true",alt:"OppCost"})),(0,i.kt)("h2",{id:"a-new-hope"},"A new hope"),(0,i.kt)("p",null,"A great way to reduce holdout size without compromising experiment accuracy is to ",(0,i.kt)("strong",{parentName:"p"},"flip GeoLift on its head"),": instead of showing media to the treatment group and holding out the control group, you holdout the treatment group and show media to the control group.  This is what we refer to as an Inverse GeoLift."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://github.com/facebookincubator/GeoLift/blob/main/website/static/img/InverseLiftTable.png?raw=true",alt:"InverseTable"})),(0,i.kt)("p",null,"Inverse GeoLifts have a different interpretation than Standard GeoLifts.  Instead of measuring the contribution that media is having on the treatment locations, you are measuring the opportunity cost that holding out media has on the treatment locations."),(0,i.kt)("p",null,"The main assumption here is that positive and negative effects are interchangeable.  In other words, if you would run a Standard or an Inverse GeoLift, the only thing that would change is the sign of the effect, not its absolute value.  ",(0,i.kt)("strong",{parentName:"p"},"Don\u2019t worry"),": when setting up a GeoLift and deciding which is the best treatment group for the experiment, the difference between the detected effect and the true effect is a variable that we are taking into account to rank different location combinations. Treatment setups that have a low difference are preferred and will be highly ranked.  ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/facebookincubator/GeoLift/blob/main/vignettes/GeoLift_Walkthrough.md#power-analysis"},"Check here")," to see what the ranking variables look like in our Walkthrough."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://github.com/facebookincubator/GeoLift/blob/main/website/static/img/TypesGeoLift.png?raw=true",alt:"TypesGeoLift"})),(0,i.kt)("h2",{id:"tips-for-building-and-analyzing-an-inverse-geolift"},"Tips for building and analyzing an Inverse GeoLift"),(0,i.kt)("h3",{id:"determine-budget-for-the-test"},"Determine budget for the test."),(0,i.kt)("p",null,"As long as you know your Cost Per Incremental Conversion (CPIC), Standard GeoLifts will tell you the minimum budget that you should invest in the treatment group.  For Inverse GeoLifts, we have to interpret the budget suggestion as the minimum amount of money that should be taken away from the treatment group.  You can see these values in the ",(0,i.kt)("inlineCode",{parentName:"p"},"Investment")," column from the output of ",(0,i.kt)("inlineCode",{parentName:"p"},"GeoLiftMarketSelection"),"."),(0,i.kt)("p",null,"If your treatment group is currently investing less than the required budget, then it will be hard to detect an effect, given that the CPIC is accurate.  You should try to select treatment setups that have a current investment that is below the absolute value of the required budget.  If there are no feasible options,  we suggest increasing the budget for all markets within the control group to ensure that the minimum amount of investment in the treatment group is met.  While this could change Business As Usual media circumstances, it becomes necessary in order to run a well-powered experiment. A good ad hoc rule for these cases is to compute the extra budget needed by calculating the difference between the required budget and the current investment in treatment and scaling that by the treatment investment share over total investment.  This will give you the value that you need to put up to run a successful experiment."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://github.com/facebookincubator/GeoLift/blob/main/website/static/img/ExtraInvestment.png?raw=true",alt:"ExtraInvestment"})),(0,i.kt)("h3",{id:"keep-an-eye-on-the-weights-for-the-counterfactual"},"Keep an eye on the weights for the counterfactual."),(0,i.kt)("p",null,"When setting up the test, you can access the weights for each of the control locations with the ",(0,i.kt)("inlineCode",{parentName:"p"},"GetWeights()")," method.  This will show you how each of the locations that will not be treated (shown media ads) will be weighted within the counterfactual."),(0,i.kt)("p",null,"When running an Inverse GeoLift, it\u2019s important to guarantee that you will show media ads in these locations.  If available, you can validate this by getting an investment report by location and ensuring that all locations with a positive weight in the counterfactual from GeoLift are being shown ads.  If this condition is not met, we could be observing a very small treatment effect due to dilution of media within the control group, when the real treatment effect could be large."),(0,i.kt)("h3",{id:"look-for-symmetric-power-curves"},"Look for symmetric power curves"),(0,i.kt)("p",null,"A symmetric power curve with respect to the y axis will guarantee that there are no considerable differences for a particular setup when changing from a Standard to an Inverse GeoLift.  This is another guarantee that our assumptions for these types of tests hold.  You can visualize this by running the ",(0,i.kt)("inlineCode",{parentName:"p"},"GeoLiftPower()")," function with positive and negative effects, a larger ",(0,i.kt)("inlineCode",{parentName:"p"},"lookback_window")," and plotting its output.  You can check for examples of what it should look like in our Github Walkthrough."),(0,i.kt)("h3",{id:"calculate-the-treatments-cpic"},"Calculate the Treatment\u2019s CPIC"),(0,i.kt)("p",null,"At the end of your experiment, you will want to know how much each incremental action in the treatment group cost.  Since you did not invest in the treatment, you need to estimate the budget in that group.  In order to do so, you can calculate the sum of GeoLift weights from the counterfactual and multiply them by the investment per location in the control.  Dividing it by the incremental conversions will give you the Cost Per Incremental Conversion."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://github.com/facebookincubator/GeoLift/blob/main/website/static/img/CPICEquation.png?raw=true",alt:"CPIC"})),(0,i.kt)("h2",{id:"whats-up-next"},"What\u2019s up next?"),(0,i.kt)("p",null,"Stay tuned for our next blog posts, related to topics like:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Calibrating your MMM model with GeoLift."),(0,i.kt)("li",{parentName:"ul"},"What should my lookback window be?"),(0,i.kt)("li",{parentName:"ul"},"When should our GeoLift test start?")),(0,i.kt)("h2",{id:"want-to-try-out-your-first-inverse-geolift"},"Want to try out your first Inverse GeoLift?"),(0,i.kt)("p",null,"Install our Github package by ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/facebookincubator/GeoLift#installing-geolift"},"following this link"),", or join our Facebook Group if you have further questions on our open source tool!"))}f.isMDXComponent=!0}}]);