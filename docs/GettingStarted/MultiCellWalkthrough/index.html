<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/GeoLift/blog/rss.xml" title="GeoLift RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/GeoLift/blog/atom.xml" title="GeoLift Atom Feed"><title data-react-helmet="true">Multi-Cell Walkthrough | GeoLift</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://facebookincubator.github.io//GeoLift/docs/GettingStarted/MultiCellWalkthrough"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Multi-Cell Walkthrough | GeoLift"><meta data-react-helmet="true" name="description" content="---"><meta data-react-helmet="true" property="og:description" content="---"><link data-react-helmet="true" rel="icon" href="/GeoLift/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://facebookincubator.github.io//GeoLift/docs/GettingStarted/MultiCellWalkthrough"><link data-react-helmet="true" rel="alternate" href="https://facebookincubator.github.io//GeoLift/docs/GettingStarted/MultiCellWalkthrough" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://facebookincubator.github.io//GeoLift/docs/GettingStarted/MultiCellWalkthrough" hreflang="x-default"><link rel="stylesheet" href="/GeoLift/assets/css/styles.db823e0d.css">
<link rel="preload" href="/GeoLift/assets/js/runtime~main.d9d7d514.js" as="script">
<link rel="preload" href="/GeoLift/assets/js/main.927bcde2.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/GeoLift/"><div class="navbar__logo"><img src="/GeoLift/img/logo.svg" alt="GeoLift Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/GeoLift/img/logo.svg" alt="GeoLift Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">GeoLift</b></a><a class="navbar__item navbar__link navbar__link--active" href="/GeoLift/docs/intro">Documentation</a><a class="navbar__item navbar__link" href="/GeoLift/Successes">Success Cases</a><a class="navbar__item navbar__link navbar__link--active" href="/GeoLift/docs/About">About</a><a class="navbar__item navbar__link" href="/GeoLift/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebookincubator/GeoLift/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">🌜</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">🌞</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/GeoLift/docs/intro">Welcome to GeoLift</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" href="/GeoLift/docs/GettingStarted/InstallingR">Getting Started</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/GeoLift/docs/GettingStarted/InstallingR">Getting Started with GeoLift</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/GeoLift/docs/GettingStarted/Walkthrough">GeoLift Walkthrough</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/GeoLift/docs/GettingStarted/MultiCellWalkthrough">Multi-Cell Walkthrough</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_2fq0" href="/GeoLift/docs/Methodology/">Methodology</a><button aria-label="Toggle the collapsible sidebar category &#x27;Methodology&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/GeoLift/docs/Best Practices/BestPractices">Best Practices</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/GeoLift/docs/About">About GeoLift</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Multi-Cell Walkthrough</h1></header><hr><h2 class="anchor anchorWithStickyNavbar_31ik" id="introduction-to-multi-cell-geolifts">Introduction to Multi-Cell GeoLifts<a class="hash-link" href="#introduction-to-multi-cell-geolifts" title="Direct link to heading">​</a></h2><p>One of the key competitive advantages of Geo-Experimental techniques such as GeoLift is that they can empower decision-makers to make apples-to-apples comparisons across different channels. Multi-Cell experiments on GeoLift take this concept to the next level by allowing users to easily set-up and analyze complex experimental designs where more than one channel or strategy is measured simultaneously. With Multi-Cell GeoLifts you can:</p><ul><li>Compare the incremental effect and ROI of two or more channels.</li><li>Improve a channel&#x27;s strategy by evaluating which of two or more implementations provides better business results.</li><li>Optimize your media mix based on data and science!</li></ul><hr><h2 class="anchor anchorWithStickyNavbar_31ik" id="multi-cell-tests-with-geolift">Multi-Cell Tests with GeoLift<a class="hash-link" href="#multi-cell-tests-with-geolift" title="Direct link to heading">​</a></h2><p>Starting on v2.5 of GeoLift, a new set of functions were introduced to run Multi-Cell tests. In this context, each cell refers to a different test group which will be used to measure and compare across strategies or channels. After identifying the KPI that will be measured with the experiment, the typical flow of a Multi-Cell experiment is as follows:</p><ol><li><p>Determine how many cells or test groups will be used in the experiment.</p></li><li><p>Run <code>MultiCellMarketSelection</code> with the pre-determined number of cells (<code>k</code>). This function will return <code>k</code> optimal simultaneous test groups.</p></li><li><p>Use <code>MultiCellPower</code> to obtain a detailed Power Curve and required investment for each cell.</p></li></ol><ul><li>[Optional]<!-- -->: <code>MultiCellWinner</code> can provide valuable information if the test&#x27;s objective is to determine whether a strategy/channel is statistically significantly better than the others. The output of this function will specify what would be needed for a cell to be declared winner based on statistical tests of equivalence.</li></ul><ol start="4"><li><p>Run the campaigns.</p></li><li><p>Run inference with <code>GeoLiftMultiCell</code>, find out the true incremental value of each cell, conclude whether there was a winner, and use the results to optimize your strategy!</p></li></ol><p>After downloading GeoLift v2.5 (or greater), the first step is to load the package:</p><div class="codeBlockContainer_K1bP language-r theme-code-block"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Load libraries</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">library(GeoLift)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">library(dplyr)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><hr><h2 class="anchor anchorWithStickyNavbar_31ik" id="1-determining-the-number-of-cells">1. Determining the number of Cells<a class="hash-link" href="#1-determining-the-number-of-cells" title="Direct link to heading">​</a></h2><p>Figuring out how many cells will be measured in a GeoLift test is a crucial first step in the Multi-Cell process. Here, it is important to take into consideration that each cell will be measured by one or more test regions (city, state, DMA, etc.). Therefore, the total number of cells that <strong>can</strong> be measured with a GeoLift is bounded by the available data. Our recommendation is to be very conservative with the number of cells in a single GeoLift study.</p><p>For this Walkthrough we will explore a cross-channel test to measure and compare the Lift of our largest Social Media and Paid Search channels. We will use the sample data included in this package:</p><div class="codeBlockContainer_K1bP language-r theme-code-block"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">data(GeoLift_PreTest)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Read into GeoLifts format with GeoDataRead</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">GeoTestData_PreTest &lt;- GeoDataRead(data = GeoLift_PreTest,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    date_id = &quot;date&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    location_id = &quot;location&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    Y_id = &quot;Y&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    X = c(), #empty list as we have no covariates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    format = &quot;yyyy-mm-dd&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    summary = TRUE)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Plot the KPI&#x27;s historical values</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">GeoPlot(GeoTestData_PreTest)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><img alt="GeoPlot" src="/GeoLift/assets/images/MC_treatment_plot-4748e2e833a4cffb51747469a2564375.png"></p><p>The dataset contains the pre-treatment daily sales for 40 US cities across 90 days. The data-frame contains three variables: location (city), date (in “yyyy-mm-dd” format), and Y (number of conversions/KPI in each day/location).</p><p>Finally, it is important to highlight the trade-off between number of cells in a Multi-Cell GeoLift test and the model fit. Given that increasing the number of cells necessarily decreases the total available units in the pool of controls, adding too many cells can significantly reduce the model fit and accuracy. In our example, given that we only have 40 cities in total, it would be advisable to not run a Multi-Cell test with more than 2 or 3 cells.</p><hr><h2 class="anchor anchorWithStickyNavbar_31ik" id="2-finding-test-markets-with-multicellmarketselection">2. Finding test markets with <code>MultiCellMarketSelection</code><a class="hash-link" href="#2-finding-test-markets-with-multicellmarketselection" title="Direct link to heading">​</a></h2><p>Once the number of cells, <code>k</code>, is determined, we can proceed to find the optimal test markets for each cell through <code>MultiCellMarketSelection()</code>. Relying on a sampling method defined by the user, the algorithm will create <code>k</code> similar groups. For each group, the algorithm will run a series of simulations to determine the best combinations of test and control locations.</p><p>The key parameters needed to run this function are:</p><ul><li><p><code>data</code>: A data frame containing the historical conversions by geographic unit. This object must contain at least: a “location” column with the geo name, a “Y” column with the outcome data (such as units), a “time” column with the indicator of the time period (starting at 1), and covariates (if available). Using the data frame generated by <code>GeoDataRead()</code> is the best way to make sure we have the correct format. For this example, we will use <code>GeoTestData_PreTest</code>.</p></li><li><p><code>k</code>: The number of partitions or cells. For our example we will analyze a <code>k = 2</code> corresponding to the Social Media and Search channels.</p></li><li><p><code>sampling_method</code>: Sampling method used to create the <code>k</code> partitions in the data set. At the moment, only <a href="https://en.wikipedia.org/wiki/Systematic_sampling" target="_blank" rel="noopener noreferrer">systematic sampling</a> (<code>sampling_method = &#x27;systematic&#x27;</code>) is available, but more options will be added in the future.</p></li><li><p><code>top_choices</code>: Specifies the number of top markets per cell to be displayed by the output.</p></li><li><p><code>N</code>: List of number of test markets to calculate power for. The values in this list represent the different test-market sizes we want to explore for each cell. This parameter is often guided by the budget and scope of the test we want to implement. For our example, we will analyze smaller tests with two and three test markets per cell (the remaining would be part of the control). We will do so by setting this parameter to <code>c(2,3)</code>.</p></li><li><p><code>X</code> (Optional): List of the names of the covariates in the data. In our example we don’t have any covariates so we’ll leave it empty.</p></li><li><p><code>Y_id</code>, <code>location_id</code>, and <code>time_id</code>: Names of the outcome, location, and time variables. These parameters will let our function know are the names of these variables in our data frame. If left empty, this parameter will default to the standard values provided by <code>GeoDataRead()</code> which are: <code>Y</code>, <code>location</code>, and <code>time</code>.</p></li><li><p><code>effect_size</code>: This parameter contains a vector of different effect sizes (or lifts) we want to simulate. For simplicity of analysis, we <strong>strongly recommend focusing on either all positive or negative values for this parameter</strong>. For this example, we will set this parameter to a sequence of lifts between 0 and 25 percent with 2.5% increments, that is, seq(0,0.25,0.025).</p></li><li><p><code>treatment_periods</code>: Specifies the test length. We recommend to specify a single treatment length for Multi-cell GeoLift Market Selections. In this example, we will analyze a 15-day test so we will set <code>treatment_periods = c(15)</code>.</p></li><li><p><code>lookback_window</code>: A number indicating how far back in time the simulations for the power analysis should go. For instance, a value equal to 7 would simulate power for the last seven days. In general, when the historical data is stable (it doesn’t vary wildly from one day/region to another) we can obtain a very robust and reliable power analysis by just looking into the most recent possible test (in other words, <code>lookback_window = 1</code>). It is important to mention that increasing the values in this parameter can significantly increase the algorithm’s run-time. A common best practice is to keep <code>lookback_window = 1</code> for <code>MultiCellMarketSelection</code> and then increasing it if needed in the next step of the Multi-Cell process.</p></li><li><p><code>cpic</code>: List of values indicating the Cost Per Incremental Conversion per cell, that is, on average how much do we typically need to spend to bring one incremental conversion. CPIC estimates can typically be obtained from Marketing Mix Models, Conversion Lifts, and previous experiments/geo-experiments. This value is key to get a good estimate of the budget that we will need to run a well-powered test. If there is no reliable information about the Cost Per Incremental Conversion, the default will be set to <code>cpic = 1</code>, in which case, the investment results will output the incremental units needed for a successful test. If the KPI measured is in a currency rather than in units, then it should be set as the inverse of the incremental Return on Ad Spend (<code>cpic = 1/iROAS</code>). In this example, considering that our KPI is in units we will use a <code>cpic = c(7.50,7.00)</code> for the Social Media and Paid Search cells respectively. These <code>cpic</code> values were guided by the results of previous single-cell GeoLifts.</p></li><li><p><code>alpha</code>: This parameter controls the significance Level that will be used by our model. By default <code>alpha = 0.1</code> which is equivalent to a 90% confidence level.</p></li><li><p><code>model</code>: A string that indicates the outcome model used to augment the Augmented Synthetic Control Method. Augmentation through a prognostic function can improve fit and reduce L2 imbalance metrics. The most common values used are: <code>model = &quot;None&quot;</code> (default) which won’t augment the ASCM and <code>model = &quot;Ridge&quot;</code>.</p></li><li><p><code>fixed_effects</code>: A logic flag indicating whether to include unit Fixed Effects (FE) in the model. Fixed effects are an additional parameter that we can include into our models which represents a non-random component in our data. More specifically, in our model the FE represents the “level” of each region’s time-series across the data. By adding the FE we effectively remove this level - this allows our model to focus on explaining the variations from that level rather than the full value of Y. This is helpful when the series are stable across time. However, if the series isn’t stable (it has large spikes/valleys, has a clear trend, etc.), then it can actually be a detriment to our model. By default, this parameter is set to fixed_effects = TRUE. A close inspection of GeoPlot’s output combined with knowledge of the data is key to specify this parameter. In our example, we will set fixed_effects = TRUE given that we can observe a stable behavior of sales across our markets in the historical data.</p></li><li><p><code>Correlations</code>: A logic flag indicating whether an additional column to the output with the correlations between the test regions and control markets. Given that not all locations in the pool of controls will contribute meaningfully to create our counterfactual/synthetic test region, the correlations can be a great resource to know how representative our test region is which can inform other analyses such as Marketing Mix Model calibration.</p></li><li><p><code>side_of_test</code>: A string indicating whether confidence will be determined using a one sided or a two sided test. These are the following valid values for this parameter:</p><ul><li><code>side_of_test = &quot;two_sided&quot;</code>: The test statistic is the sum of all treatment effects.</li><li><code>side_of_test = &quot;one_sided&quot;</code>: One-sided test against positive or negative effects.</li></ul></li></ul><p>Taking this inputs into consideration, we find:</p><div class="codeBlockContainer_K1bP language-r theme-code-block"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">set.seed(8) #To replicate the results</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Markets &lt;- MultiCellMarketSelection(data = GeoTestData_PreTest,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                 k = 2,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                 sampling_method = &quot;systematic&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                 top_choices = 10,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                 N = c(2,3),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                 effect_size = seq(0, 0.25, 0.025),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                 treatment_periods = c(15),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                 lookback_window = 1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                 cpic = c(7, 7.50),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                 alpha = 0.1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                 model = &quot;None&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                 fixed_effects = TRUE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                 Correlations = TRUE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                 side_of_test = &quot;one_sided&quot;)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP language-r theme-code-block"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Markets</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##    cell ID                            location duration EffectSize</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 1     1  1                 chicago, cincinnati       15      0.025</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 2     2  1                     baltimore, reno       15      0.025</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 3     1  2            cleveland, oklahoma city       15      0.050</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 4     2  2                       houston, reno       15      0.025</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 5     1  3               las vegas, saint paul       15      0.025</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 6     2  3              honolulu, indianapolis       15      0.025</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 7     1  4                nashville, san diego       15      0.025</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 8     2  4             houston, portland, reno       15      0.025</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 9     1  5               philadelphia, phoenix       15      0.025</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 10    2  5         denver, memphis, washington       15      0.050</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 11    1  6    cleveland, dallas, oklahoma city       15      0.025</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 12    2  6               baton rouge, portland       15      0.025</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 13    1  7               detroit, jacksonville       15      0.025</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 14    2  7                     denver, memphis       15      0.050</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 15    1  8         atlanta, chicago, nashville       15      0.050</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 16    2  8                 memphis, washington       15      0.025</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 17    1  9                  atlanta, nashville       15      0.050</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 18    2  9      baton rouge, houston, portland       15      0.025</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 19    1 10 columbus, jacksonville, minneapolis       15      0.025</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 20    2 10                     miami, portland       15      0.075</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##    AvgScaledL2Imbalance abs_lift_in_zero Investment ProportionTotal_Y   Holdout</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 1             0.2587293            0.001   15548.58        0.03418832 0.9658117</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 2             0.3202672            0.002   20166.19        0.04151842 0.9584816</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 3             0.5582169            0.001   60865.35        0.06599073 0.9340093</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 4             0.4149685            0.003   20507.62        0.04282716 0.9571728</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 5             0.7667228            0.003   20827.62        0.04571975 0.9542802</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 6             0.3044968            0.004   16648.88        0.03307948 0.9669205</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 7             0.4379696            0.005   17827.78        0.03891756 0.9610824</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 8             0.2643562            0.005   28790.25        0.05949740 0.9405026</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 9             0.5666373            0.007   45695.48        0.09829630 0.9017037</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 10            0.6200586            0.008   57326.25        0.05922727 0.9407727</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 11            0.6198624            0.008   36378.83        0.07923764 0.9207624</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 12            0.2284603            0.010   16299.00        0.03289916 0.9671008</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 13            0.3317333            0.008   13281.10        0.02940561 0.9705944</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 14            0.6591485            0.009   42621.00        0.04433701 0.9556630</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 15            0.5302774            0.008   55532.05        0.06089060 0.9391094</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 16            0.4803747            0.011   19126.69        0.03939854 0.9606015</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 17            0.6205455            0.008   40863.20        0.04449547 0.9555045</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 18            0.2413871            0.015   28416.38        0.05780466 0.9421953</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 19            0.3246004            0.010   24523.98        0.05485904 0.9451410</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 20            0.3733400            0.010   50877.56        0.03495877 0.9650412</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##    rank</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 1     1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 2     1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 3     2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 4     2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 5     2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 6     3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 7     4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 8     4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 9     5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 10    5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 11    6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 12    6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 13    6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 14    6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 15    8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 16    8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 17    8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 18    9</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 19    8</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 20    9</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The resulting table contains optimal test designs for this two-cell test as well as some model-fit metrics for each selection. The columns in the results represent:</p><ul><li><strong>cell</strong>: Numeric identifier for each cell. In our case, we have two cells: cell one for Social Media and cell 2 for Paid Search.</li><li><strong>ID</strong>: Numeric identifier of a test market for a given duration. The combination of <strong>cell</strong> and <strong>ID</strong> completely defines a Multi-Cell market selection.</li><li><strong>location</strong>: Identifies the test location(s).</li><li><strong>duration</strong>: Shows how many time-stamps the test will last for. Since the data in our example had daily values, we will analyze a 15 day test.</li><li><strong>EffectSize</strong>: The Effect Size represents minimum Lift needed to have a well-powered test. These values directly depend on the <code>effect_size</code> parameter of this function.</li><li><strong>Power</strong>: The row’s average power across all simulations at the specified Effect Size.</li><li><strong>AvgScaledL2Imbalance</strong>: The Scaled L2 Imbalance metric is a goodness of fit metric between 0 and 1 that represents how well the model is predicting the pre-treatment observed values through the Synthetic Control. Scaled L2 Imbalance values of 0 show a perfect match of pre-treatment values. Scaled L2 Imbalance values of 1 show that the Synthetic Control algorithm is not adding much value beyond what you could accomplish with a simple average of control locations (naive model).</li><li><strong>abs_lift_in_zero</strong>: This value represents the average estimated Lift our test markets had when we actually simulated a 0% Lift in conversions. Great test market selections often have values of abs_lift_in_zero very close to zero.</li><li><strong>Investment</strong>: The average investment needed to obtain a well-powered test given each cell&#x27;s CPIC.</li><li><strong>ProportionTotal_Y</strong>: This proportion reflects the fraction of all conversions that happen in our test regions compared to the aggregation of all markets. For example, a value of 0.10 would indicate that our test markets represent 10% of all conversions for our KPI. <strong>It is highly recommended to look for locations across cells with similar values of this metric to make the results easier to compare and contrast</strong>.</li><li><strong>Holdout</strong>: The percent of total conversions in the control markets. This value is complementary to ProportionTotal_Y.</li><li>rank: Ranking variable per cell that summarizes the values of EffectSize, Power, AvgScaledL2Imbalance, Average_MDE, and abs_lift_in_zero to help you select the best combination of test markets. The ranking variable allows for ties.</li></ul><p>Exploring the results of <code>MultiCellMarketSelection</code> we find that locations &quot;chicago, cincinnati&quot; for Cell 1 and &quot;honolulu, indianapolis&quot; in Cell 2 provide excelent values across all model-fit metrics such as a low EffectSize, small AvgScaledL2Imbalance, an abs_lift_in_zero close to zero, and a very similar value of ProportionTotal_Y.</p><p>We could define our Multi-Cell test markets as a list:</p><div class="codeBlockContainer_K1bP language-r theme-code-block"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Cell and Market IDs in a list</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">test_locs &lt;- list(cell_1 = 1, #chicago, cincinnati</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                  cell_2 = 3) #honolulu, indianapolis</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Moreover, we could plot these results to observe how the model fits the historical data.</p><div class="codeBlockContainer_K1bP language-r theme-code-block"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plot(Markets,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     test_markets = test_locs,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     type = &quot;Lift&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     stacked = TRUE)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><img alt="MarketSelection" src="/GeoLift/assets/images/MC_MarketSelection-504cc5054627c908e6ad60d2a81d92ff.png"></p><hr><h2 class="anchor anchorWithStickyNavbar_31ik" id="3-detailed-power-curves">3. Detailed Power Curves<a class="hash-link" href="#3-detailed-power-curves" title="Direct link to heading">​</a></h2><p>Perhaps the most important piece of part of any Market Selection process is to obtain and analyze the test&#x27;s Power Curve. These curves tell us how sensible our test is at detecting a given Lift, it&#x27;s statistical power, and give us a good estimate of the necessary budget needed to run the Multi-Cell test. The <code>MultiCellPower</code> function can be used to calculate the Power Curves for a given set of cells through simulations on the historical data.</p><p>The <code>MultiCellPower</code> function is very easy to use as it will leverage the set-up and results we obtained from <code>MultiCellMarketSelection</code>. The most important parameters to calculate the Power Curves are:</p><ul><li><p><code>x</code>: A <code>MultiCellMarketSelection</code> object.</p></li><li><p><code>test_markets</code>: A list of the selected <code>market_ID</code> per <code>cell_ID</code>. It is important to make sure that this list contains exactly <code>k</code> numeric values corresponding to the results of <code>MultiCellMarketSelection</code>. The recommended layout is <code>list(cell_1 = 1, cell2 = 1, cell3 = 1,...)</code>, for our example we will set it to the previously defined list: <code>test_locs</code>.</p></li><li><p><code>effect_size</code>: This parameter contains the different Lifts that we will simulate for our test. For each value in this parameter, the algorithm will simulate a GeoLift test with that Lift and will assess the statistical significance of the results to determine the test&#x27;s Statistical Power. For this parameter, it is important to make sure that the sequence includes zero. For our example, we will set both positive and negative effect sizes to observe the curve&#x27;s form and to see how symetrical it is.</p></li><li><p><code>lookback_window</code>: This parameter indicates how long back in history the simulations will go. Setting a <code>lookback_window</code> to a value greater than one is particularly important to correctly assess the Power and estimate the budget of tests with significant seasonality or which aren&#x27;t very stable. For this example, we will simulate an entire week, thus <code>lookback_window = 7</code>.</p></li><li><p><code>side_of_test</code>: Indicates whether a <code>one_sided</code> or <code>two_sided</code> test will be performed. The function will use the same value used for <code>MultiCellMarketSelection</code> unless specified otherwise. In this example, we will leave this parameter blank so it will default to the value specified in the previous step (<code>one_sided</code>).</p></li></ul><div class="codeBlockContainer_K1bP language-r theme-code-block"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Power &lt;- MultiCellPower(Markets,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        test_markets = test_locs,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        effect_size =  seq(-0.5, 0.5, 0.05),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        lookback_window = 7)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Plotting the results shows the Power Curve for each cell.</p><div class="codeBlockContainer_K1bP language-r theme-code-block"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">plot(Power,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     actual_values = TRUE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     smoothed_values = FALSE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     show_mde = TRUE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     breaks_x_axis = 15,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     stacked = TRUE)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><img alt="PowerCurves" src="/GeoLift/assets/images/MC_Power-b11f5f104a2330fd8b7b6877610ad515.png"></p><p>The plot shows that both Power Curves are ideal as they are: symmetric, centered at zero, and have relatively small effect sizes needed to accurately detect lift (<!-- -->~<!-- -->5%). Moreover, we observe that, despite different <code>cpic</code>s, an investment of $50,000 per cell should be more than enough to achieve a significant Lift.</p><hr><h2 class="anchor anchorWithStickyNavbar_31ik" id="optional-multicellwinner">[Optional]<!-- -->: <code>MultiCellWinner</code><a class="hash-link" href="#optional-multicellwinner" title="Direct link to heading">​</a></h2><p>While most of the times the objective of a Multi-Cell test is simply to accurately measure the incremental effect of different channels/strategies, sometimes we want to go a step further and declare which one of the competing cells is statistically significantly better or worse than the others. In this case, we can use the <code>MultiCellWinner</code> function, to determine what must happen for a cell to be declared a <strong>&quot;Winner&quot;</strong>. This function works by answering the following question: for a given baseline Effect Size, how much better must the incremental Return on Ad Spend (iROAS) of a cell be so that it provides a statistically significantly better Lift overall?</p><p>The most important parameters of the <code>MultiCellWinner</code> function are:</p><ul><li><p><code>x</code>: A <code>MultiCellPower</code> object created by the <code>MultiCellPower</code> function. By using this object, the winner analysis will be conducted on the cells defined previously. Specifically, Cell 1: Chicago and Cincinnati and Cell B: Honolulu and Indianapolis.</p></li><li><p><code>effect_size</code>:    A numeric value representing the Lift that will be simulated across all cells. If not specified (default), the algorithm will use the largest lift found in <code>MultiCellPower</code> that provides a well-powered test across all cells. For this example, we will se the baseline Lift at 10%.</p></li><li><p><code>geolift_type</code>: Specifies the type of GeoLift test to be performed which can be: &quot;standard&quot; (test regions will receive the treatment) or &quot;inverse&quot; (test regions will be holded-out from the treatment). More information on standard and inverse tests can be found <a href="https://facebookincubator.github.io/GeoLift/blog/inverse-geolift" target="_blank" rel="noopener noreferrer">here</a>.</p></li><li><p><code>ROAS</code>: Provides a series of incremental Return on Ad Spend (iROAS) values to assess. In this example we will use ROAS that range from 1x to 10x increasing by 0.5x through the sequence: <code>seq(1,10,0.5)</code>.</p></li><li><p><code>alpha</code>: Significance Level. By default 0.1.</p></li><li><p><code>method</code>: This parameter indicates the mathematical method used to calculate the aggregate ATT Confidence Intervals. The user can choose between &quot;conformal&quot; (recommended) and &quot;jackknife+&quot;.</p></li><li><p><code>stat_test</code>: Indicates the stat test that will be used in our calculations. This parameter can take the values of &quot;Total&quot;, &quot;Negative&quot;, or &quot;Positive&quot;. For this example, we will set this parameter to &quot;Positive&quot; as we conducted a Standard GeoLift Multi-Cell test.</p></li></ul><div class="codeBlockContainer_K1bP language-r theme-code-block"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Winners &lt;- MultiCellWinner(Power,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           effect_size = 0.1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           geolift_type = &quot;standard&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           ROAS = seq(1,10,0.5),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           alpha = 0.1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           method = &quot;conformal&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           stat_test = &quot;Positive&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP language-r theme-code-block"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Winners</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##                cell_A incremental_A lowerCI_Cell_A upperCI_Cell_A</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 1 chicago, cincinnati      78534.65        76612.9         557051</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##                   cell_B incremental_B lowerCI_Cell_B upperCI_Cell_B duration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 1 honolulu, indianapolis      9065.861        3467.71        75443.9       15</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##   ROAS</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 1    9</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>These results show that Cell 1 would need to be 9x more effective than Cell 2 to be declared a <strong>&quot;Winner&quot;</strong>.</p><hr><h2 class="anchor anchorWithStickyNavbar_31ik" id="4-campaign-execution">4. Campaign Execution<a class="hash-link" href="#4-campaign-execution" title="Direct link to heading">​</a></h2><p>After successfully selecting the test markets with <code>MultiCellMarketSelection</code> and <code>GeoLiftPower</code>, the campaigns can be executed. For this test we will run ads on Social Media for the cities of Chicago and Cincinnati (Cell 1), Paid Search ads for the cities of Honolulu and Indianapolis (Cell 2), and holdout the rest of the locations in our data-set for a 15-day test.</p><p>We can use the simulated Multi-Cell data included in the <code>GeoLift</code> package as follows:</p><div class="codeBlockContainer_K1bP language-r theme-code-block"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">data(GeoLift_Test_MultiCell)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Read test data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">GeoTestData_Test &lt;- GeoDataRead(data = GeoLift_Test_MultiCell,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    date_id = &quot;date&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    location_id = &quot;location&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    Y_id = &quot;Y&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    X = c(), #empty list as we have no covariates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    format = &quot;yyyy-mm-dd&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    summary = TRUE)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## #####       Summary       #####</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Raw Number of Locations: 40</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Time Periods: 105</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Final Number of Locations (Complete): 40</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP language-r theme-code-block"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Plot the historical and test data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">GeoPlot(GeoTestData_Test,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        treatment_start = 91)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><img alt="TreatmentGeoPlot" src="/GeoLift/assets/images/MC_treatment_plot-4748e2e833a4cffb51747469a2564375.png"></p><hr><h2 class="anchor anchorWithStickyNavbar_31ik" id="5-multi-cell-inference-for-geolift">5. Multi-Cell Inference for GeoLift<a class="hash-link" href="#5-multi-cell-inference-for-geolift" title="Direct link to heading">​</a></h2><p>The final step in the process is to calculate the Lift generated by our Social Media and Paid Search campaigns. We can leverage the <code>GeoLiftMultiCell</code> function to easily perform statistical inference on our test. The key parameters of this function are:</p><ul><li><p><code>data</code>: A data.frame containing the historical conversions by geographic unit. It requires at least a &quot;locations&quot; column with the geo name, a &quot;Y&quot; column with the outcome data (units), a time column with the indicator of the time period (starting at 1), and covariates (optional). In this example, we will use the <code>GeoTestData_Test</code> data frame we just obtained through <code>GeoDataRead</code>.</p></li><li><p><code>locations</code>:A list of lists of test markets per cell. The recommended layout is <code>list(cell_1 = list(&quot;locA&quot;), cell2 = list(&quot;locB&quot;), cell3 = list(&quot;locC&quot;),...)</code>.</p></li><li><p><code>treatment_start_time</code>: Time index of the start of the treatment. 91 for this example.</p></li><li><p><code>treatment_end_time</code>: Time index of the end of the treatment. 105 for this example.</p></li><li><p><code>alpha</code>: Significance level. Set to 0.1 by default.</p></li><li><p><code>model</code>: This parameter indicates which (if any) prognostic function will be used to augment our Augmented Sythetic Control Method (ASCM). The available options for this parameter are: &quot;None&quot;, &quot;Ridge&quot;, &quot;GYSN&quot;, and &quot;best&quot;. We will set this parameter to &quot;best&quot; to let the algorithm determine the optimal prognostic function.</p></li><li><p><code>fixed_effects</code>: Indicates whether to include a Fixed Effects component in the model or not. Given our prior knowledge of this simulated data, we will set it to <code>TRUE</code>.</p></li><li><p><code>ConfidenceIntervals</code>: Indicates whether to estimate the Confidence Intervals for the total Lift.</p></li><li><p><code>method</code>: Identifies the mathematical methodology that will be used to calculate our Confidence Intervals. We will set this parameter to the recommended option which is &quot;conformal&quot;.</p></li><li><p><code>geolift_type</code>: String that specifies the type of GeoLift test to be performed. This parameter can be set to: &quot;standard&quot; or &quot;inverse&quot;. Given that this was a &quot;standard&quot; Multi-Cell GeoLift test, we will set this parameter accordingly.</p></li><li><p><code>stat_test</code>: Determines the test statistic to be used by GeoLift. Valid options are: &quot;Total&quot;, &quot;Negative&quot;, and &quot;Positive&quot;. We will use the latter as this was a standard GeoLift Multi-Cell test.</p></li><li><p><code>winner_declaration</code>: Logic flag indicating whether to compute a winner cell analysis. If set to TRUE (default), both pairwise and total statistical significance tests will be performed.</p></li></ul><div class="codeBlockContainer_K1bP language-r theme-code-block"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># First we specify our test locations as a list</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">test_locations &lt;- list(cell_1 = list(&quot;chicago&quot;, &quot;cincinnati&quot;),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       cell_2 = list(&quot;honolulu&quot;, &quot;indianapolis&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#Then, we run MultiCellResults</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MultiCellResults &lt;- GeoLiftMultiCell(data = GeoTestData_Test,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     locations = test_locations,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     treatment_start_time = 91,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     treatment_end_time = 105,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     alpha = 0.1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     model = &quot;best&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     fixed_effects = TRUE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     ConfidenceIntervals = TRUE,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     method = &quot;conformal&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     stat_test = &quot;Positive&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     winner_declaration = TRUE)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Selected Ridge as best model.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Selected Ridge as best model.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##### Pairwise  Comparisons #####</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##                Cell_A  Lower_A   Upper_A                 Cell_B Lower_B</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 1 chicago, cincinnati 16673.88 146162.26 honolulu, indianapolis 8745.23</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##     Upper_B Winner</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 1 118669.62   &lt;NA&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP language-r theme-code-block"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">MultiCellResults</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## #####     Cell 1 Results    #####</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Test results for 15 treatment periods, from time-stamp 91 to 105 for test markets:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 1 CHICAGO</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 2 CINCINNATI</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## #####     Test Statistics    #####</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Percent Lift: 22.8%</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## p-value: 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Incremental Y: 20215</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Average Estimated Treatment Effect (ATT): 673.819</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## The results are significant at a 95% level. (ONE-SIDED POSITIVE LIFT TEST)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## There is a 0% chance of observing an effect this large or larger assuming treatment effect is zero.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## #####     Cell 2 Results    #####</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Test results for 15 treatment periods, from time-stamp 91 to 105 for test markets:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 1 HONOLULU</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## 2 INDIANAPOLIS</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## #####     Test Statistics    #####</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Percent Lift: 7.1%</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## p-value: 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Incremental Y: 6493</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Average Estimated Treatment Effect (ATT): 216.423</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## The results are significant at a 95% level. (ONE-SIDED POSITIVE LIFT TEST)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## There is a 0% chance of observing an effect this large or larger assuming treatment effect is zero.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The results show that the Social Media campaign had a significant Lift equal to 22.8% while the Paid Search campaigns generated a 7.1% Lift. And while the results of the test show a higher Lift by Cell 1, the wide Confidence Intervals do not allow us to declare a winner at a 90% confidence level. We can dig deeper into the results through the <code>summary()</code> of our Multi-Cell GeoLift object. The <code>summary()</code> method has two options based on the <code>table</code> parameter:</p><ol><li>If <code>table = TRUE</code> a summary table of the results per cell will be printed.</li></ol><div class="codeBlockContainer_K1bP language-r theme-code-block"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#Short summary of the results</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">summary(MultiCellResults, table = TRUE)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## | Cell|Location               | Duration|Lift  | Incremental|     ATT| pValue|Stat_Test                    | Stat_Sig|Prognostic_Func |Winner |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## |----:|:----------------------|--------:|:-----|-----------:|-------:|------:|:----------------------------|--------:|:---------------|:------|</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## |    1|CHICAGO, CINCINNATI    |       15|22.8% |       20215| 673.819|      0|ONE-SIDED POSITIVE LIFT TEST |        1|RIDGE           |       |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## |    2|HONOLULU, INDIANAPOLIS |       15|7.1%  |        6493| 216.423|      0|ONE-SIDED POSITIVE LIFT TEST |        1|RIDGE           |       |</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="2"><li>If <code>table = FALSE</code> the complete summary method for each cell will be outputted.</li></ol><div class="codeBlockContainer_K1bP language-r theme-code-block"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Deep dive into the results</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">summary(MultiCellResults, table = FALSE)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## #####     Cell 1 Results    #####</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## GeoLift Results Summary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## #####     Test Statistics    #####</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Average ATT: 673.819</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Percent Lift: 22.8%</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Incremental Y: 20215</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * P-value: 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * 90% Confidence Interval: (16673.879, 146162.255)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## #####   Balance Statistics   #####</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * L2 Imbalance: 956.678</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Scaled L2 Imbalance: 0.1694</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Percent improvement from naive model: 83.06%</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Average Estimated Bias: -0.441</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## #####     Model Weights      #####</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Prognostic Function: RIDGE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Model Weights:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * portland: 0.2121</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * austin: 0.1521</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * nashville: 0.1463</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * san diego: 0.1371</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * minneapolis: 0.1364</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * new york: 0.06</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * baton rouge: 0.0558</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * reno: 0.0474</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * miami: 0.0359</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * atlanta: 0.0118</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * houston: 0.0044</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * san antonio: 0.0041</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * salt lake city: -0.0013</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * oakland: -8e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * philadelphia: -7e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * oklahoma city: -4e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * baltimore: 2e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * las vegas: 2e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * dallas: 2e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * new orleans: -1e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * san francisco: -1e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * boston: -1e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * columbus: 1e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * washington: -1e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * kansas city: -1e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * phoenix: -1e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * memphis: -1e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * milwaukee: -1e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * cleveland: -1e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * saint paul: 1e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## #####     Cell 2 Results    #####</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## GeoLift Results Summary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## #####     Test Statistics    #####</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Average ATT: 216.423</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Percent Lift: 7.1%</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Incremental Y: 6493</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * P-value: 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * 90% Confidence Interval: (8745.226, 118669.618)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## #####   Balance Statistics   #####</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * L2 Imbalance: 1508.472</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Scaled L2 Imbalance: 0.326</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Percent improvement from naive model: 67.4%</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Average Estimated Bias: 11.782</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## #####     Model Weights      #####</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## ##################################</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Prognostic Function: RIDGE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## * Model Weights:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * austin: 0.3567</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * tucson: 0.2351</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * portland: 0.1744</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * nashville: 0.0988</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * baton rouge: 0.0823</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * detroit: 0.0445</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * orlando: 0.0391</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * phoenix: -0.0136</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * columbus: -0.0129</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * salt lake city: -0.0125</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * memphis: -0.0106</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * oklahoma city: 0.0102</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * miami: -0.0093</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * houston: 0.0073</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * las vegas: -0.007</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * baltimore: -0.0066</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * san francisco: -0.006</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * jacksonville: 0.006</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * kansas city: 0.0054</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * milwaukee: 0.0043</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * cleveland: 0.0042</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * philadelphia: 0.0041</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * denver: -0.0032</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * new orleans: -0.0028</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * los angeles: 0.0023</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * washington: 0.0023</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * minneapolis: 0.002</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * san diego: 0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * dallas: 0.0016</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * san antonio: 0.0014</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * reno: 0.0014</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * atlanta: -0.0013</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * boston: 0.0013</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * new york: -9e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * oakland: 6e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##  * saint paul: -1e-04</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">##</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Finally, we can plot the results to observe both the Lift and ATT plots.</p><div class="codeBlockContainer_K1bP language-r theme-code-block"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">plot(MultiCellResults, type = &quot;Lift&quot;, stacked = TRUE)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><img alt="ResultsLift" src="/GeoLift/assets/images/MC_Lift-d26bcbe06ccdc60104c53cad7150e85b.png"></p><div class="codeBlockContainer_K1bP language-r theme-code-block"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">plot(MultiCellResults, type = &quot;ATT&quot;, stacked = TRUE)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><img alt="ResultsATT" src="/GeoLift/assets/images/MC_ATT-70decde4c86ab6ba3a3e6e90debb8f0b.png"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebookincubator/GeoLift/docs/GettingStarted/MultiCellWalkthrough.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/GeoLift/docs/GettingStarted/Walkthrough"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">GeoLift Walkthrough</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/GeoLift/docs/Methodology/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">GeoLift Methodology</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction-to-multi-cell-geolifts" class="table-of-contents__link toc-highlight">Introduction to Multi-Cell GeoLifts</a></li><li><a href="#multi-cell-tests-with-geolift" class="table-of-contents__link toc-highlight">Multi-Cell Tests with GeoLift</a></li><li><a href="#1-determining-the-number-of-cells" class="table-of-contents__link toc-highlight">1. Determining the number of Cells</a></li><li><a href="#2-finding-test-markets-with-multicellmarketselection" class="table-of-contents__link toc-highlight">2. Finding test markets with <code>MultiCellMarketSelection</code></a></li><li><a href="#3-detailed-power-curves" class="table-of-contents__link toc-highlight">3. Detailed Power Curves</a></li><li><a href="#optional-multicellwinner" class="table-of-contents__link toc-highlight">Optional: <code>MultiCellWinner</code></a></li><li><a href="#4-campaign-execution" class="table-of-contents__link toc-highlight">4. Campaign Execution</a></li><li><a href="#5-multi-cell-inference-for-geolift" class="table-of-contents__link toc-highlight">5. Multi-Cell Inference for GeoLift</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/GeoLift/docs/intro">Documentation</a></li><li class="footer__item"><a href="https://www.facebookblueprint.com/student/path/253063-geolift-marketing-measurement?sid=cd9a46bc-9685-4af4-8ac3-4482e858fba9&amp;sid_i=5" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Blueprint Course<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/GeoLift/Successes">Success Cases</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://www.facebook.com/groups/fbgeolift" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCzkuhQFBCHz9TxzUXlNUINg" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/GeoLift/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebookincubator/GeoLift/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/data-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Data Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Cookie Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="/GeoLift/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/GeoLift/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright © 2022 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/GeoLift/assets/js/runtime~main.d9d7d514.js"></script>
<script src="/GeoLift/assets/js/main.927bcde2.js"></script>
</body>
</html>