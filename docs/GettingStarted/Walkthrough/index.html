<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/GeoLift/blog/rss.xml" title="GeoLift Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/GeoLift/blog/atom.xml" title="GeoLift Blog Atom Feed"><title data-react-helmet="true">GeoLift Walkthrough | GeoLift</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://facebookincubator.github.io//GeoLift/docs/GettingStarted/Walkthrough"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="GeoLift Walkthrough | GeoLift"><meta data-react-helmet="true" name="description" content="---"><meta data-react-helmet="true" property="og:description" content="---"><link data-react-helmet="true" rel="shortcut icon" href="/GeoLift/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://facebookincubator.github.io//GeoLift/docs/GettingStarted/Walkthrough"><link data-react-helmet="true" rel="alternate" href="https://facebookincubator.github.io//GeoLift/docs/GettingStarted/Walkthrough" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://facebookincubator.github.io//GeoLift/docs/GettingStarted/Walkthrough" hreflang="x-default"><link rel="stylesheet" href="/GeoLift/assets/css/styles.38b72916.css">
<link rel="preload" href="/GeoLift/assets/js/runtime~main.7b640dfb.js" as="script">
<link rel="preload" href="/GeoLift/assets/js/main.6f0eae49.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/GeoLift/"><img src="/GeoLift/img/logo.svg" alt="GeoLift Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/GeoLift/img/logo.svg" alt="GeoLift Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">GeoLift</b></a><a class="navbar__item navbar__link navbar__link--active" href="/GeoLift/docs/intro">Documentation</a><a class="navbar__item navbar__link" href="/GeoLift/Successes">Success Cases</a><a class="navbar__item navbar__link navbar__link--active" href="/GeoLift/docs/About">About</a><a class="navbar__item navbar__link" href="/GeoLift/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebookincubator/GeoLift/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">üåû</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/GeoLift/docs/intro">Welcome to GeoLift</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Getting Started</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/GeoLift/docs/GettingStarted/InstallingR">Getting Started with GeoLift</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/GeoLift/docs/GettingStarted/Walkthrough">GeoLift Walkthrough</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Methodology</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Best Practices</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/GeoLift/docs/About">About GeoLift</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>GeoLift Walkthrough</h1></header><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="1-data-and-r-environment"></a>1. Data and R Environment<a class="hash-link" href="#1-data-and-r-environment" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="set-up-of-the-r-environment"></a>Set-up of the R Environment<a class="hash-link" href="#set-up-of-the-r-environment" title="Direct link to heading">#</a></h3><p>After installing the <code>GeoLift</code> package, it&#x27;s important to load it into our R session.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">library(GeoLift)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="data"></a>Data<a class="hash-link" href="#data" title="Direct link to heading">#</a></h3><p>To show an end-to-end implementation of GeoLift we will use simulated
data of 40 US cities across 90 days to first design a test, select test
markets, run power calculations, and finally calculate the Lift caused
by the campaign. As with every GeoLift test, we start analyzing pre-test
historical information. We will use data included in the <code>GeoLift</code>
package.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">data(GeoLift_PreTest)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The <code>GeoLift_PreTest</code> dataset contains three variables: location (city),
date (in ‚Äúyyyy-mm-dd‚Äù format), and Y (number of conversions in each
day/location).</p><p>The first step to run a <code>GeoLift</code> test is to read the data into the
proper format using the <code>GeoDataRead</code> function.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">GeoTestData_PreTest &lt;- GeoDataRead(data = GeoLift_PreTest,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    date_id = &quot;date&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    location_id = &quot;location&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    Y_id = &quot;Y&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    format = &quot;yyyy-mm-dd&quot;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">head(GeoTestData_PreTest)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;   location time    Y</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 1  atlanta    1 3384</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 2  atlanta    2 3904</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 3  atlanta    3 5734</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 4  atlanta    4 4311</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 5  atlanta    5 3686</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 6  atlanta    6 3374</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This function analyzes the dataset, handles locations with missing data,
and returns a data frame with time-stamps instead of dates. In this
case, since we‚Äôre inputting daily data each time unit represents a day.</p><p>A good next step is to plot the panel data and observe it‚Äôs trend,
contribution per location, and also to detect any data anomalies before
moving on to the data analysis.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">GeoPlot(GeoTestData_PreTest,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Y_id = &quot;Y&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        time_id = &quot;time&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        location_id = &quot;location&quot;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><img alt="GeoPlot" src="/GeoLift/assets/images/plotting-1-2c326791d205a65f63c30cb675f52e98.png"></p><p>In this case we see a similar pattern that‚Äôs shared across all
locations.</p><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="2-power-analysis"></a>2. Power Analysis<a class="hash-link" href="#2-power-analysis" title="Direct link to heading">#</a></h2><p>Running a power analysis is fundamental prior to executing a test. It is
only through a thorough statistical analysis of our data that we can
set-up a test for success. In general, through the power analysis we can
find the optimal number of test locations, best test duration, select
the ideal test and control markets, get a good idea of the budget needed
to run a test, find which is the Minimum Detectable Effect to obtain
significant results, and set proper expectations for the results.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="how-many-test-markets"></a>How many test markets?<a class="hash-link" href="#how-many-test-markets" title="Direct link to heading">#</a></h3><p>In general, there are two main types of users of <code>GeoLift</code>‚Äôs power
calculations: * Those who through prior analysis already know which
locations they want to test and simply want to validate their test
design. * Users who do not have an initial design in mind and want to
do a data-driven test set-up.</p><p>For those who fall under the second scenario, the first step is to get
an idea of how many test locations we would generally need to obtain a
well-powered test. This step allows us to better understand the data and
narrow down the number of test configurations. This analysis can be
achieved using the <code>NumberLocations</code> function of <code>GeoLift</code> which works
by simulating a large amount of tests and assess their results and fit
statistics.</p><p>The parameters used in the <code>NumberLocations</code> function inform the names
of the time, location, and units variables (time_id, location_id, and
time_id respectively) in the input data. We also specify the length of
the test we have on mind with the treatment_periods parameter (if not
sure, you can enter a list of test lengths too), the number of
simulations we want to run, control the output through the optional
plotting and progress bar parameters, set the desired significance and
power level, and also decide whether to include unit fixed-effects to
the model. There are several additional parameters that can be used to
further customize the simulations and outputs which can be accessed in
the package‚Äôs documentation.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">resultsNum &lt;- NumberLocations(data = GeoTestData_PreTest,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                Y_id = &quot;Y&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                location_id = &quot;location&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                time_id = &quot;time&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                n_sim = 500,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                treatment_periods = 15,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                plot = TRUE,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                power = 0.8,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                alpha = 0.1,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                fixed_effects = TRUE,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                ProgressBar = TRUE)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; Attempting to load the environment &#x27;package:tidyr&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; [1] &quot;Average Power By Number of Locations&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; # A tibble: 12 x 3</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;        n mean_pow mean_L2ScaledImbalance</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;    &lt;dbl&gt;    &lt;dbl&gt;                  &lt;dbl&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  1     0    0                      1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  2     1    0.886                  0.445</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  3     2    0.872                  0.401</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  4     4    0.88                   0.366</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  5     7    0.874                  0.351</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  6     8    0.886                  0.356</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  7    10    0.874                  0.359</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  8    13    0.85                   0.375</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  9    15    0.844                  0.369</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 10    16    0.832                  0.375</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 11    18    0.798                  0.387</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 12    20    0.834                  0.396</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><img alt="NumberLocations" src="/GeoLift/assets/images/numberlocations-1-a4862453718d8da664609e320f4255ba.png"></p><p>he results show that we can obtain well-powered test even from just a
few locations. Moreover, the output shows the Scaled L2 Imbalance
metric, which is a metric between 0 and 1 that represents how well the
model is predicting the pre-treatment observed values through the
Synthetic Control. Scaled L2 Imbalance values of 0 show a perfect match
of pre-treatment values and values of 1 show a very inaccurate
prediction. In this case, we observe that this metric is relatively
stable once we have a couple or more test locations. These results
provide a good starting point as we now know that we can get a
well-powered test even if we just have a few test locations. In any
case, it is important to mention that <code>NumberLocations</code> is just menat to
guide our analysis as power can drastically change between different
market selections even if we keep the same number of test markets.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="market-selection"></a>Market Selection<a class="hash-link" href="#market-selection" title="Direct link to heading">#</a></h3><p>Once that we have a better idea of how many markets are needed for a
well.powered test, we can proceed to the Market Selection. In this step
we use simulations to find which are the best combinations of test and
control locations for a predetermined number of test markets. This
process can be accomplished using the <code>GeoLiftPower.search</code> function
which will simulate a large amount of tests using rolling windows of
dates to find which combinations of test and control locations can
consistently provide stable and well-powered tests.</p><p>Similar to the previous function, we communicate to
<code>GeoLiftPower.search</code> the layout of our object through the time_id,
location_id, and Y_id parameters. In addition, we set a test length
(or lengths if unsure) using the treatment_periods parameter and
significance level through alpha. Moreover, the horizon parameter allows
us to focus more on more recent time-stamps. This is especially useful
if we see that older time-periods have significantly different dynamics
to the more recent (ones where the test would take place). In this case,
setting horizon = 50 is telling <code>GeoLiftPower.search</code> that we should
focus on time periods [50,90]. In addition, the N parameter specifies
the total number of locations that can be part of the test. Following
the results found by <code>NumberLocations</code> we focus on test designs that
have between 2 and 4 cities in the test group. Finally, some of the
outputs of the function can be controlled through parameters such as
top_results which will determine how many of the top locations will be
printed.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">resultsSearch &lt;- GeoLiftPower.search(data = GeoTestData_PreTest,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     treatment_periods = c(15),</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     N = c(2,3,4),</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     horizon = 50,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     Y_id = &quot;Y&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     location_id = &quot;location&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     time_id = &quot;time&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     top_results = 20,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     alpha = 0.1,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     type = &quot;pValue&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     fixed_effects = TRUE,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                     ProgressBar = TRUE)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; [1] &quot;Best 20 test markets:&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; # A tibble: 20 x 1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;    location</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;    &lt;chr&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  1 chicago, portland</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  2 chicago, cincinnati</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  3 chicago, cincinnati, houston, portland</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  4 chicago, houston, portland</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  5 columbus, jacksonville, minneapolis</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  6 columbus, jacksonville, milwaukee, minneapolis</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  7 jacksonville, minneapolis</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  8 atlanta, chicago, cincinnati, san diego</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  9 jacksonville, kansas city, milwaukee, oakland</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 10 kansas city, milwaukee, oakland</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 11 columbus, minneapolis, new york</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 12 detroit, jacksonville, new orleans</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 13 atlanta, chicago, cincinnati</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 14 austin, oakland</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 15 nashville, san diego</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 16 cleveland, denver, washington</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 17 dallas, washington</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 18 cleveland, dallas, denver, washington</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 19 cleveland, denver</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 20 atlanta, chicago, reno</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The results show the best combination of test markets, the average power
that the combination was able to provide, its the average Scaled L2
Imbalance across all simulations, the proportion of total conversions
that the test markets represent, and it‚Äôs overall rank determined by
power and imbalance. In this case, we see that a test that uses the
combination of Chicago and Portland as test locations appears as the
top-ranked choice.</p><p>Inspecting the object created by <code>GeoLiftPower.search</code> shows us a more
detailed list of results.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">head(resultsSearch,10)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;                                                location mean_pow</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 1                                     chicago, portland        1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 2                                   chicago, cincinnati        1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 3                chicago, cincinnati, houston, portland        1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 4                            chicago, houston, portland        1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 5                   columbus, jacksonville, minneapolis        1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 6        columbus, jacksonville, milwaukee, minneapolis        1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 7                             jacksonville, minneapolis        1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 8               atlanta, chicago, cincinnati, san diego        1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 9         jacksonville, kansas city, milwaukee, oakland        1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 10                      kansas city, milwaukee, oakland        1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;    mean_scaled_l2_imbalance ProportionTotal_Y rank</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 1                 0.1732343        0.03306537    1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 2                 0.1909320        0.03418832    2</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 3                 0.1981689        0.07576405    3</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 4                 0.2248921        0.05797087    4</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 5                 0.2315280        0.05485904    5</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 6                 0.2405941        0.07980000    6</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 7                 0.2410849        0.03032910    7</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 8                 0.2442581        0.07972448    8</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 9                 0.2574026        0.14137854    9</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 10                0.2685320        0.12663961   10</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>One key part of <code>GeoLiftPower.search</code> is that it use the similarities
between the market‚Äôs time series to determine hot to best combine them
into the test and control groups. This is important as Synthetic Control
Methods rely on the availability of similar markets to the test in order
to create the counterfactual. For this reason, the <code>MarketSelection</code>
function is a core part of <code>GeoLiftPower.search</code>. To obtain a better
understanding of the similarity structure between our cities you could
run <code>MarketSelection</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">MarketSelection(GeoTestData_PreTest, location_id = &quot;location&quot;, time_id = &quot;time&quot;, Y_id = &quot;Y&quot;)[1:5,1:5]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;      [,1]          [,2]           [,3]            [,4]          [,5]</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; [1,] &quot;atlanta&quot;     &quot;chicago&quot;      &quot;las vegas&quot;     &quot;cleveland&quot;   &quot;reno&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; [2,] &quot;austin&quot;      &quot;oakland&quot;      &quot;oklahoma city&quot; &quot;kansas city&quot; &quot;saint paul&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; [3,] &quot;baltimore&quot;   &quot;philadelphia&quot; &quot;reno&quot;          &quot;chicago&quot;     &quot;houston&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; [4,] &quot;baton rouge&quot; &quot;portland&quot;     &quot;cincinnati&quot;    &quot;san diego&quot;   &quot;chicago&quot;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; [5,] &quot;boston&quot;      &quot;new orleans&quot;  &quot;jacksonville&quot;  &quot;milwaukee&quot;   &quot;detroit&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The results show a matrix of similarities, where columns 2 onward
represents an ordered list of the most similar location to the one
showed in the first column. For instance, these results show that the
most similar city to Atlanta is Chicago followed by Las Vegas and
Cleveland.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="what-about-the-minum-detectable-effect"></a>What about the Minum Detectable Effect?<a class="hash-link" href="#what-about-the-minum-detectable-effect" title="Direct link to heading">#</a></h3><p>Even though <code>GeoLiftPower.search</code> showed us which combination of test
and control markets were able to consistently obtain well-powered
results in a Synthetic Control test, it doesn‚Äôt tell us what is the Lift
we would need to obtain that powerful test. That‚Äôs why we recommend to
supplement the results of <code>GeoLiftPower.search</code> with the simulations run
by the function <code>GeoLiftPowerFinder</code>. More specifically, while the
former analyzes the stability of the time-series and ability of a SCM to
replicate the results, the latter explores the Minimum Detectable Effect
that a combination of test and control locations would provide.</p><p>The parameters needed by <code>resultsFind</code> are very similar to the ones used
by <code>GeoLiftPower.search</code> with the difference that this function doesn‚Äôt
use a horizon as it will focus on the most recent available data to run
a test as it is the one that would be closest to the market dynamics
that a test would experience. Also, a sequence of Effect Sizes or Lifts
are needed by this function as part of the effect_size parameter. Each
element on this sequence will be assessed to find the test‚Äôs Minimum
Detectable Effect. In this case, we entered two different test lengths:
10 and 15 days as part of the treatment_periods parameter. Setting the
plot_best parameter to TRUE will output the plot of the top 4 test
markets to perform a deeper dive.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">resultsFind &lt;- GeoLiftPowerFinder(data = GeoTestData_PreTest,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                  treatment_periods = c(10,15),</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                  N = c(2,3,4),</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                  Y_id = &quot;Y&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                  location_id = &quot;location&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                  time_id = &quot;time&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                  effect_size = seq(0, 0.5, 0.05),</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                  top_results = 5,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                  alpha = 0.1,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                  fixed_effects = TRUE,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                  ProgressBar = TRUE,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                  plot_best = TRUE)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><img alt="PowerFinder_10" src="/GeoLift/assets/images/powerfinder-1-8c32ac91078b3d659deb2487f9bb03fd.png">
<img alt="PowerFinder_15" src="/GeoLift/assets/images/powerfinder-2-9aa9b10feeb09430fe33031e58ca7966.png"></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">head(resultsFind,10)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;                                    location pvalue duration MinDetectableEffect</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 1                         chicago, portland      0       10                 0.1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 2                         chicago, portland      0       15                 0.1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 3                       chicago, cincinnati      0       15                 0.1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 4    chicago, cincinnati, houston, portland      0       10                 0.1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 5  columbus, minneapolis, new york, orlando      0       10                 0.1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 6                     baton rouge, portland      0       15                 0.1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 7  columbus, minneapolis, new york, orlando      0       15                 0.1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 8                 jacksonville, minneapolis      0       10                 0.1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 9                chicago, houston, portland      0       10                 0.1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 10               chicago, houston, portland      0       15                 0.1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;    ScaledL2Imbalance ProportionTotal_Y rank</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 1          0.1682310        0.03306537    1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 2          0.1738778        0.03306537    2</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 3          0.1842457        0.03418832    3</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 4          0.1966996        0.07576405    4</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 5          0.2188363        0.08010168    5</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 6          0.2220392        0.03289916    6</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 7          0.2245568        0.08010168    7</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 8          0.2278603        0.03032910    8</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 9          0.2305628        0.05797087    9</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 10         0.2336638        0.05797087   10</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The results echo the findings of <code>GeoLiftPower.search</code> and show that the
combination of Chicago and Portland as test locations is optimal in
terms of stability and a Minimum Detectable Effect that is both small
and which has high certainty. Moreover, the Scaled L2 Imbalance results
show a good fit of the Synthetic Control on pre-treatment periods.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="finding-the-duration-and-budget"></a>Finding the Duration and Budget<a class="hash-link" href="#finding-the-duration-and-budget" title="Direct link to heading">#</a></h3><p>So far our Market Selection based on Power Analyses provided us with a
promising combination of test and control locations. Specifically, we
would focus our treatment on Chicago and Portland while putting the rest
of the locations in the holdout group. However, we still haven‚Äôt found
the ideal test duration and estimated budget to necessary to run this
test. To do so, we need to perform a more thorough Power Analysis
focused on our chosen test configuration. The <code>GeoLiftPower</code> function
takes a set of test cities defined in the locations parameter, together
with a horizon, a sequence of lifts or effect sizes to be analyzed, and
a Cost Per Incremental Conversion (CPIC). This CPIC will allow us to
estimate the budget needed to achieve the required lift for a
well-powered test. Moreover, providing a list of different length
durations in the treatment_periods parameter lets us see what the ideal
test duration should be for this particular set of test locations.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">locs &lt;- c(&quot;chicago&quot;, &quot;portland&quot;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">resultsPow &lt;- GeoLiftPower(GeoTestData_PreTest,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           locations = locs,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           effect_size = seq(0,0.25,0.01),</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           treatment_periods = c(10,15),</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           horizon = 50,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           Y_id = &quot;Y&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           location_id = &quot;location&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           time_id = &quot;time&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                           cpic = 7.50)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plot(resultsPow, actual_values = TRUE)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;    duration lift     power</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 1        10 0.00 0.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 2        10 0.01 0.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 3        10 0.02 0.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 4        10 0.03 0.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 5        10 0.04 0.0312500</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 6        10 0.05 0.1562500</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 7        10 0.06 0.4062500</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 8        10 0.07 0.5625000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 9        10 0.08 0.7812500</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 10       10 0.09 0.9687500</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 11       10 0.10 0.9687500</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 12       10 0.11 0.9687500</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 13       10 0.12 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 14       10 0.13 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 15       10 0.14 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 16       10 0.15 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 17       10 0.16 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 18       10 0.17 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 19       10 0.18 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 20       10 0.19 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 21       10 0.20 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 22       10 0.21 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 23       10 0.22 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 24       10 0.23 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 25       10 0.24 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 26       10 0.25 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 27       15 0.00 0.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 28       15 0.01 0.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 29       15 0.02 0.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 30       15 0.03 0.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 31       15 0.04 0.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 32       15 0.05 0.1851852</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 33       15 0.06 0.3333333</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 34       15 0.07 0.5555556</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 35       15 0.08 0.7037037</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 36       15 0.09 0.7407407</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 37       15 0.10 0.8888889</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 38       15 0.11 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 39       15 0.12 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 40       15 0.13 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 41       15 0.14 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 42       15 0.15 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 43       15 0.16 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 44       15 0.17 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 45       15 0.18 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 46       15 0.19 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 47       15 0.20 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 48       15 0.21 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 49       15 0.22 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 50       15 0.23 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 51       15 0.24 1.0000000</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 52       15 0.25 1.0000000</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><img alt="Power_10" src="/GeoLift/assets/images/geoliftpower-1-55c33220e7f611a151824d0a8415a801.png">
<img alt="Power_15" src="/GeoLift/assets/images/geoliftpower-2-63add0668d3b554243fc67010f30899c.png"></p><p>The power curves for the 10 and 15 day tests show similar results with a
minimum required lift of roughly 10%. Moreover, budget calculations
indicate that at a $7.50 Cost Per Incremental Conversion, a well-powered
15-day test would require a budget of around $60,000.</p><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="3-analyzing-the-test-results"></a>3. Analyzing the Test Results<a class="hash-link" href="#3-analyzing-the-test-results" title="Direct link to heading">#</a></h2><p>Based on the results of the Power Calculations, a test is set-up in
which a 15-day marketing campaign will be executed in the cities of
Chicago and Portland while the rest of the locations will be put on
holdout. Following the completion from this marketing campaign, we
receive sales data that reflects these results. This new data-set
contains the same format and information as the pre-test one but
crucially includes results for the duration of the campaign. Depending
on the vertical and product, adding a post-campaign cooldown period
might be useful.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="test-data"></a>Test Data<a class="hash-link" href="#test-data" title="Direct link to heading">#</a></h3><p>Data for the campaign results can be accessed at <code>GeoLift_Test</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">data(GeoLift_Test)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Similarly to the process executed at the beginning of the Power Analysis
phase, we read the data into GeoLift‚Äôs format using the <code>GeoDataRead</code>
function.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">GeoTestData_Test &lt;- GeoDataRead(data = GeoLift_Test,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    date_id = &quot;date&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    location_id = &quot;location&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    Y_id = &quot;Y&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                    format = &quot;yyyy-mm-dd&quot;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">head(GeoTestData_Test)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;   location time    Y</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 1  atlanta    1 3384</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 2  atlanta    2 3904</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 3  atlanta    3 5734</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 4  atlanta    4 4311</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 5  atlanta    5 3686</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 6  atlanta    6 3374</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The results can also be plotted using the <code>GeoPlot</code> function. However,
for post-campaign data we can include the time-stamp at which the
campaign started through the treatment_start parameter to clearly
separate the two periods. Plotting the time-series is always useful to
detect any anomalies with the data and to start noticing patterns with
the test.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">GeoPlot(GeoTestData_Test,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Y_id = &quot;Y&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        time_id = &quot;time&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        location_id = &quot;location&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        treatment_start = 91)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><img alt="GeoPlotTestData" src="/GeoLift/assets/images/plottingTest-1-0a25898315721e1b9ba8bbb0dea5dbbe.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="geolift-inference"></a>GeoLift Inference<a class="hash-link" href="#geolift-inference" title="Direct link to heading">#</a></h3><p>The next step in the process is to calculate the actual Lift caused by
the marketing campaigns on our test locations. To do so we make use of
the <code>GeoLift</code> function, which will take as input the GeoLift dataframe
as well as information about the test such as which were the cities in
the treatment group, when the test started, and when it ended through
the locations, treatment_start_time, and treatment_end_time
parameters respectively.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">GeoTest &lt;- GeoLift(Y_id = &quot;Y&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    data = GeoTestData_Test,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    locations = locs,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    treatment_start_time = 91,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    treatment_end_time = 105)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; GeoLift Output</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; Test results for 15 treatment periods, from time-stamp 91 to 105 for test markets:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 1 CHICAGO</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 2 PORTLAND</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; ##################################</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; #####     Test Statistics    #####</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; ##################################</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; Percent Lift: 5.4%</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; Incremental Y: 4667</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; Average Estimated Treatment Effect (ATT): 155.556</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; The results are significant at a 95% level.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; There is a 0.5% chance of observing an effect this large or larger assuming treatment effect is zero.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The results show that the campaigns led to a 5.4% lift in units sold
corresponding to 4667 incremental units sold for this 15-day test.
Moreover, the Average Estimated Treatment Effect (also known as ATT) is
of 155.556 units every day of the test. Most importantly, we observe
that these results are statistically significant at a 95% level. In
fact, there‚Äôs only a 1.1% chance of observing an effect of this
magnitude or larger if the actual treatment effect was zero. In other
words, it is extremely unlikely that these results are just due to
chance. To dig deeper into the results, we can run the summary of our
GeoLift object.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">summary(GeoTest)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; GeoLift Results Summary</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; ##################################</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; #####     Test Statistics    #####</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; ##################################</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * Average ATT: 155.556</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * Percent Lift: 5.4%</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * Incremental Y: 4667</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * P-value: 0</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; ##################################</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; #####   Balance Statistics   #####</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; ##################################</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * L2 Imbalance: 909.489</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * Scaled L2 Imbalance: 0.1636</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * Percent improvement from naive model: 83.64%</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * Average Estimated Bias: NA</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; ##################################</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; #####     Model Weights      #####</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; ##################################</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * Prognostic Function: NONE</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * Model Weights:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * austin: 0.0465</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * baton rouge: 0.1335</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * cincinnati: 0.2272</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * dallas: 0.0739</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * honolulu: 0.0673</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * houston: 0.0046</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * miami: 0.2028</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * minneapolis: 0.09</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * nashville: 0.0685</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * new york: 0.0046</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * reno: 0.0306</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * san antonio: 0.0054</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * san diego: 0.0451</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The summary show additional test statistics such as the p-value which
was equal to 0.01 confirming the highly statistical significance of
these results. Moreover, the summary function provides Balance
Statistics which display data about our model‚Äôs fit. The main metric of
model fit used in GeoLift is the L2 Imbalance which represents how far
our synthetic control was from the actual observed values in the
pre-treatment period. That is, how similar the synthetic Chicago +
Portland unit we crated is from the observed values of these cities in
the period before the intervention. A small L2 Imbalance score means
that our model did a great job replicating our test locations while a
large one would indicate a poor fit. However, the L2 Imabalnce metric is
scale-dependent, meaning that it can‚Äôt be compared between models with
different KPIs or number of testing periods. For instance, the L2
Imbalance of a model run on units sold will be significantly larger than
a model ran for tons of product sold even if they represent the same
basic underlying metric.</p><p>Therefore, given that it‚Äôs hard to tell simply by looking at the value
of the L2 Imbalance metric whether the model had a good or poor fit, we
also included the Scaled L2 Imbalance stat which is easier to interpret
as it‚Äôs bounded in the range between 0 and 1. A value close to zero
represents a good model fit while values nearing 1 indicate a poor
performance by the Synthetic Control Model. This scaling is accomplished
by comparing the Scaled L2 Imbalance of our Synthetic Control Method
with the Scaled L2 Imbalance obtained by a baseline/naive model (instead
of carefully calculating which is the optimal weighting scheme for the
Synthetic Control, we assign equal weights to each unit in the donor
pool). The latter provides an upper bound of L2 Imbalance, therefore,
the Scaled L2 Imbalance shows us how much better our GeoLift model is
from the baseline.</p><p>In fact, another way to look at the Scaled L2 Imbalance is the percent
improvement from a naive model which can be obtained by subtracting our
model‚Äôs Scaled L2 Imbalance from 100%. In this case, an improvement
close to 100% (which corresponds to a Scaled L2 Imbalance close to zero)
represents a good model fit. Finally, we also include the weights that
generate our Synthetic Control. In this test we note that the locations
that contribute the most to our GeoLift model are Cincinnati, Miami, and
Baton Rouge.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">plot(GeoTest, type = &quot;Lift&quot;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><img alt="LiftPlot" src="/GeoLift/assets/images/plot_Lift-1-0c0ac37a30894e29a3fa5b959cd10c9f.png"></p><p>Plotting the results is a great way to assess the model‚Äôs fit and how
effective the campaign was. Taking a close look at the pre-treatment
period (white background) provides insight into how well our Synthetic
Control Model fitted our data. In this specific example, we see that the
observed values of the Chicago + Portland test represented in the solid
black line were closely replicated by our model shown as the dashed red
line. Furthermore, looking at the test period, we can notice the
campaign‚Äôs incrementality shown as the difference between the sales
observed in the test markets and our counterfactual synthetic location.
This marked difference between an almost-exact match in pre-treatment
periods and gap in test time-stamps provides strong evidence of a
successful campaign.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">plot(GeoTest, type = &quot;ATT&quot;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><img alt="PlotATT" src="/GeoLift/assets/images/plot_ATT-1-11c6a674ae4bb5207a72f2ab98b6777a.png"></p><p>Looking at the Average Estimated Treatment Effect‚Äôs plot can also be
extremely useful. The ATT metric shows us the magnitude of the Average
Treatment Effect on a daily basis in contrast with the previous (Lift)
plot which focused on aggregated effects. Moreover, this is a great
example of a good GeoLift model as it has very small ATT values in the
pre-treatment period and large ones when the treatment is administered
to our test locations. Moreover, point-wise confidence intervals are
included in this chart which help us measure how meaningful each day
Lift has been.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="improving-the-model"></a>Improving The Model<a class="hash-link" href="#improving-the-model" title="Direct link to heading">#</a></h3><p>While the results obtained from the test are robust and highly
significant, a useful feature of GeoLift is its ability to improve the
model fit even further and reduce bias through augmentation by a
prognostic function. There are several options for augmentation of the
standard GeoLift model such as regularization (specifically Ridge) and a
application of Generalized Synthetic Control Model (GSC). While each of
these approaches provide it‚Äôs own set of advantages, for instance Ridge
regularization usually performs well when the number of units and
time-periods isn‚Äôt large while GSC helps improve fit for situations with
many pre-treatment periods, GeoLift offers the option to let the model
decide which is the best approach by setting the model parameter to
‚Äúbest‚Äù.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">GeoTestBest &lt;- GeoLift(Y_id = &quot;Y&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        data = GeoTestData_Test,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        locations = locs,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        treatment_start_time = 91,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        treatment_end_time = 105,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        model = &quot;best&quot;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; GeoLift Output</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; Test results for 15 treatment periods, from time-stamp 91 to 105 for test markets:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 1 CHICAGO</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; 2 PORTLAND</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; ##################################</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; #####     Test Statistics    #####</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; ##################################</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; Percent Lift: 5.5%</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; Incremental Y: 4704</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; Average Estimated Treatment Effect (ATT): 156.805</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; The results are significant at a 95% level.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; There is a 1.2% chance of observing an effect this large or larger assuming treatment effect is zero.</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">summary(GeoTestBest)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; GeoLift Results Summary</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; ##################################</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; #####     Test Statistics    #####</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; ##################################</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * Average ATT: 156.805</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * Percent Lift: 5.5%</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * Incremental Y: 4704</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * P-value: 0.01</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; ##################################</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; #####   Balance Statistics   #####</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; ##################################</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * L2 Imbalance: 903.525</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * Scaled L2 Imbalance: 0.1626</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * Percent improvement from naive model: 83.74%</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * Average Estimated Bias: -1.249</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; ##################################</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; #####     Model Weights      #####</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; ##################################</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * Prognostic Function: RIDGE</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt; * Model Weights:</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * atlanta: 3e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * austin: 0.0467</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * baltimore: 1e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * baton rouge: 0.1337</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * boston: -4e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * cincinnati: 0.2273</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * columbus: 1e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * dallas: 0.0741</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * denver: 1e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * detroit: 1e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * honolulu: 0.0674</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * houston: 0.0048</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * indianapolis: 1e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * jacksonville: -1e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * kansas city: -1e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * los angeles: 2e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * memphis: -2e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * miami: 0.2029</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * milwaukee: -2e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * minneapolis: 0.0901</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * nashville: 0.0687</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * new orleans: -2e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * new york: 0.0048</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * oakland: -0.001</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * oklahoma city: -7e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * orlando: 1e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * philadelphia: -4e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * reno: 0.0308</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * saint paul: 2e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * salt lake city: -3e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * san antonio: 0.0056</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * san diego: 0.0452</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * san francisco: 1e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#&gt;  * tucson: -1e-04</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plot(GeoTestBest, type = &quot;Lift&quot;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><img alt="PlotLiftBest" src="/GeoLift/assets/images/GeoLiftBest-1-54bcb65bacb9c801e5fc64cf4c3d4c25.png"></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><pre tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">plot(GeoTestBest, type = &quot;ATT&quot;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><img alt="PlotATTBest" src="/GeoLift/assets/images/GeoLiftBest-2-c0ad18aac6947aa0d562f37e7c85cc0e.png"></p><p>The new results augment the GeoLift model with a Ridge prognostic
function which improves the model fit as seen in the new L2 Imbalance
metrics. This additional robustness is translated in a small increase in
the Percent Lift. Furthermore, by augmenting the model with a prognostic
function, we have an estimate of the estimated bias.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebookincubator/GeoLift/docs/GettingStarted/Walkthrough.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/GeoLift/docs/GettingStarted/InstallingR"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Getting Started with GeoLift</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/GeoLift/docs/Methodology/Methodology"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">GeoLift Methodology ¬ª</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-data-and-r-environment" class="table-of-contents__link">1. Data and R Environment</a><ul><li><a href="#set-up-of-the-r-environment" class="table-of-contents__link">Set-up of the R Environment</a></li><li><a href="#data" class="table-of-contents__link">Data</a></li></ul></li><li><a href="#2-power-analysis" class="table-of-contents__link">2. Power Analysis</a><ul><li><a href="#how-many-test-markets" class="table-of-contents__link">How many test markets?</a></li><li><a href="#market-selection" class="table-of-contents__link">Market Selection</a></li><li><a href="#what-about-the-minum-detectable-effect" class="table-of-contents__link">What about the Minum Detectable Effect?</a></li><li><a href="#finding-the-duration-and-budget" class="table-of-contents__link">Finding the Duration and Budget</a></li></ul></li><li><a href="#3-analyzing-the-test-results" class="table-of-contents__link">3. Analyzing the Test Results</a><ul><li><a href="#test-data" class="table-of-contents__link">Test Data</a></li><li><a href="#geolift-inference" class="table-of-contents__link">GeoLift Inference</a></li><li><a href="#improving-the-model" class="table-of-contents__link">Improving The Model</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/GeoLift/docs/intro">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/GeoLift/Successes">Success Cases</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://www.facebook.com/groups/fbgeolift" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/GeoLift/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebookincubator/GeoLift/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/data-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Data Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Cookie Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="/GeoLift/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/GeoLift/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright ¬© 2021 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/GeoLift/assets/js/runtime~main.7b640dfb.js"></script>
<script src="/GeoLift/assets/js/main.6f0eae49.js"></script>
</body>
</html>